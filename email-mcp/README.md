# email-mcp

A Model Context Protocol (MCP) server that lets Claude send emails via the Gmail API.

---

## Setup

### 1. Install dependencies
```bash
cd email-mcp
npm install
```

### 2. Get Gmail credentials (`token.json`)

You need a `token.json` from Google OAuth 2.0. The easiest way is to reuse the one
generated by `gmail_watcher.py`:

```bash
# From the vault root:
python gmail_watcher.py --auth
# Follow the browser prompt, then copy the saved token:
cp gmail_token.json email-mcp/token.json
```

Or generate it manually:
1. Go to [Google Cloud Console](https://console.cloud.google.com/)
2. Enable the **Gmail API**
3. Create **OAuth 2.0 credentials** (Desktop app)
4. Download `client_secret.json`
5. Run the auth helper and save the resulting token as `token.json`

### 3. Configure the MCP server

Add to `~/.config/claude-code/mcp.json` (or `%APPDATA%\Claude\claude_desktop_config.json` on Windows):

```json
{
  "mcpServers": {
    "email": {
      "command": "node",
      "args": ["D:/Hackathon_0/AI_Employee_Vault/email-mcp/index.js"],
      "env": {
        "GMAIL_CREDENTIALS": "D:/Hackathon_0/AI_Employee_Vault/email-mcp/token.json"
      }
    }
  }
}
```

### 4. Start (standalone test)
```bash
GMAIL_CREDENTIALS=./token.json node index.js
```

---

## Tool: `send_email`

| Parameter | Type | Required | Description |
|-----------|------|----------|-------------|
| `to` | string | Yes | Recipient email address |
| `subject` | string | Yes | Email subject |
| `body` | string | Yes | Email body (plain text or HTML) |
| `html` | boolean | No | Set `true` to send HTML body |
| `cc` | string \| string[] | No | CC recipient(s) |
| `bcc` | string \| string[] | No | BCC recipient(s) |
| `attachments` | array | No | `[{ filename, content }]` — base64 or file path |

---

## Example tool calls

**Plain text email:**
```json
{
  "tool": "send_email",
  "arguments": {
    "to": "colleague@example.com",
    "subject": "Quick update",
    "body": "Hey, just checking in on the project status."
  }
}
```

**HTML email with CC:**
```json
{
  "tool": "send_email",
  "arguments": {
    "to": "client@example.com",
    "cc": "manager@example.com",
    "subject": "Project Proposal",
    "html": true,
    "body": "<h1>Proposal</h1><p>Please find our proposal below...</p>"
  }
}
```

**Email with attachment:**
```json
{
  "tool": "send_email",
  "arguments": {
    "to": "client@example.com",
    "subject": "Report attached",
    "body": "Please find the report attached.",
    "attachments": [
      {
        "filename": "report.pdf",
        "content": "D:/reports/report.pdf"
      }
    ]
  }
}
```

---

## File Structure

```
email-mcp/
├── index.js       # MCP server + send_email tool
├── package.json   # Dependencies
├── token.json     # Gmail OAuth token (you provide this)
└── README.md
```
